(()=>{"use strict";function t(n,e,i=null){return o=this,r=void 0,c=function*(){if(n&&(yield e(n,i),(o=n)&&Array.isArray(o.children)))for(let i of n.children.reverse())yield t(i,e,n);var o},new((a=void 0)||(a=Promise))((function(t,n){function e(t){try{f(c.next(t))}catch(t){n(t)}}function i(t){try{f(c.throw(t))}catch(t){n(t)}}function f(n){var o;n.done?t(n.value):(o=n.value,o instanceof a?o:new a((function(t){t(o)}))).then(e,i)}f((c=c.apply(o,r||[])).next())}));var o,r,a,c}function n(t){return Array.isArray(t.fills)&&t.fills.filter((t=>"IMAGE"===t.type))}!function(t){if(!t)return null;const[n,e,i,o,r,a]=t.match(/rgba?\(([\d\.]+), ([\d\.]+), ([\d\.]+)(, ([\d\.]+))?\)/)||[],c=a&&0===parseFloat(a);e&&i&&o&&!c&&(parseInt(e),parseInt(i),parseInt(o),a&&parseFloat(a))}("rgba(178, 178, 178, 1)");var e=function(t,n,e,i){return new(e||(e=Promise))((function(o,r){function a(t){try{f(i.next(t))}catch(t){r(t)}}function c(t){try{f(i.throw(t))}catch(t){r(t)}}function f(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,c)}f((i=i.apply(t,n||[])).next())}))},i=function(t,n,e,i){return new(e||(e=Promise))((function(o,r){function a(t){try{f(i.next(t))}catch(t){r(t)}}function c(t){try{f(i.throw(t))}catch(t){r(t)}}function f(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,c)}f((i=i.apply(t,n||[])).next())}))};const o={},r=t=>t.toLowerCase().replace(/[^a-z]/gi,""),a={family:"Roboto",style:"Regular"};function c(t,n){for(const e in n){const i=n[e];if("data"===e&&i&&"object"==typeof i){const n=JSON.parse(t.getSharedPluginData("builder","data")||"{}")||{},e=i,o=Object.assign({},n,e);t.setSharedPluginData("builder","data",JSON.stringify(o))}else if(void 0!==i&&-1===["width","height","type","ref","children","svg"].indexOf(e))try{t[e]=n[e]}catch(i){console.warn(`Assign error for property "${e}"`,t,n,i)}}}const f=["FRAME","GROUP","SVG","RECTANGLE"],u=(t,u,l)=>{return s=void 0,d=void 0,h=function*(){const s=(null==u?void 0:u.ref)||l;if("number"!=typeof t.x||"number"!=typeof t.y)throw Error("Layer coords not defined");const d=(t=>"FRAME"===t.type||"GROUP"===t.type?figma.createFrame():"SVG"===t.type&&t.svg?figma.createNodeFromSvg(t.svg):"RECTANGLE"===t.type?figma.createRectangle():"TEXT"===t.type?figma.createText():void 0)(t);if(!d)throw Error(`${t.type} not implemented`);if(f.includes(t.type)&&s.appendChild(((t,n)=>(n.x=t.x,n.y=t.y,n.resize(t.width||1,t.height||1),c(n,t),n))(t,d)),t.ref=d,"RECTANGLE"===t.type&&n(t)&&(yield function(t){return e(this,void 0,void 0,(function*(){const i=n(t);return i&&Promise.all(i.map((t=>e(this,void 0,void 0,(function*(){t&&t.intArr&&(t.imageHash=yield figma.createImage(t.intArr).hash,delete t.intArr)})))))}))}(t)),"TEXT"===t.type){const n=d;t.fontFamily&&(n.fontName=yield function(t){return i(this,void 0,void 0,(function*(){const n=o[t];if(n)return n;const e=yield i(void 0,void 0,void 0,(function*(){return(yield figma.listAvailableFontsAsync()).filter((t=>"Regular"===t.fontName.style))})),c=t.split(/\s*,\s*/);for(const n of c){const i=r(n);for(const n of e){const e=r(n.fontName.family);if(e===i)return o[e]||(yield figma.loadFontAsync(n.fontName),o[t]=n.fontName,o[e]=n.fontName,n.fontName)}}return a}))}(t.fontFamily),delete t.fontFamily),c(n,t),n.resize(t.width||1,t.height||1),n.textAutoResize="HEIGHT";let e=0;for(t.lineHeight&&(n.lineHeight=t.lineHeight);"number"==typeof t.height&&n.height>t.height;){if(e++>5){console.warn("Too many font adjustments",n,t);break}try{n.resize(n.width+1,n.height)}catch(e){console.warn("Error on resize text:",t,n,e)}}s.appendChild(n)}return d},new((y=void 0)||(y=Promise))((function(t,n){function e(t){try{o(h.next(t))}catch(t){n(t)}}function i(t){try{o(h.throw(t))}catch(t){n(t)}}function o(n){var o;n.done?t(n.value):(o=n.value,o instanceof y?o:new y((function(t){t(o)}))).then(e,i)}o((h=h.apply(s,d||[])).next())}));var s,d,y,h};var l=function(t,n,e,i){return new(e||(e=Promise))((function(o,r){function a(t){try{f(i.next(t))}catch(t){r(t)}}function c(t){try{f(i.throw(t))}catch(t){r(t)}}function f(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,c)}f((i=i.apply(t,n||[])).next())}))};figma.showUI(__html__,{width:600,height:600});const s="HTML-TO-FIGMA RESULT";figma.ui.onmessage=n=>{return e=void 0,i=void 0,r=function*(){if("import"===n.type){yield figma.loadFontAsync(a);const{data:e}=n;let{layers:i}=e,o=figma.currentPage,r=o,c=0,f=0,d=figma.currentPage.findOne((t=>t.name===s));d&&(c=d.x,f=d.y),i.x=c,i.y=f,yield function(n,e,i){return l(this,void 0,void 0,(function*(){for(const o of n)yield t(o,((t,n)=>l(this,void 0,void 0,(function*(){try{const o=yield u(t,n,e);null==i||i({node:o,layer:t,parent:n})}catch(n){console.warn("Error on layer:",t,n)}}))))}))}([i],o,(({node:t,parent:n})=>{n||(r=t,t.name=s)})),null==d||d.remove()}},new((o=void 0)||(o=Promise))((function(t,n){function a(t){try{f(r.next(t))}catch(t){n(t)}}function c(t){try{f(r.throw(t))}catch(t){n(t)}}function f(n){var e;n.done?t(n.value):(e=n.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,c)}f((r=r.apply(e,i||[])).next())}));var e,i,o,r}})();